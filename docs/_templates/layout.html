{% extends "sphinx_book_theme/layout.html" %}

{%- set page_description -%}
{%- if pagename == 'index' -%}
Nabla is a high-performance Python ML framework with automatic differentiation, JIT compilation, SPMD sharding, and GPU acceleration built on Mojo and MAX. A fast JAX alternative with LoRA/QLoRA fine-tuning support.
{%- elif 'finetune' in pagename -%}
LoRA and QLoRA fine-tuning API reference for Nabla ML. Parameter-efficient fine-tuning with NF4 quantization, adapter merging, and checkpoint management.
{%- elif 'nn_optim' in pagename or 'optim' in pagename -%}
Optimizer API reference for Nabla ML: AdamW, SGD, and functional optimizer APIs for distributed training with automatic differentiation.
{%- elif 'nn_modules' in pagename or 'modules' in pagename -%}
Neural network modules for Nabla ML: Linear, LayerNorm, MultiHeadAttention, Transformer layers, and more. PyTorch-like API with Mojo acceleration.
{%- elif 'nn_functional' in pagename -%}
Functional neural network API for Nabla: stateless layer functions, loss functions (cross-entropy, MSE), and weight initialization (Xavier, He).
{%- elif 'transforms' in pagename -%}
Function transformations in Nabla: grad, vmap, JIT compile, vjp, jvp, jacrev, jacfwd, and shard_map for distributed SPMD computation.
{%- elif 'sharding' in pagename -%}
SPMD sharding API for Nabla: DeviceMesh, PartitionSpec, and automatic tensor sharding for distributed multi-GPU training.
{%- elif 'testing' in pagename -%}
Testing utilities for Nabla ML: assert_allclose for cross-framework numeric validation and batch_realize for pytree tensor realization.
{%- elif 'api/' in pagename -%}
API reference for {{ title }} in the Nabla ML framework. Functions, classes, and examples for high-performance machine learning with Mojo.
{%- elif 'tutorials/' in pagename -%}
{{ title }} — step-by-step Nabla ML tutorial with code examples for automatic differentiation, GPU training, and distributed computing.
{%- else -%}
{{ title }} — Nabla ML high-performance framework for automatic differentiation, JIT compilation, SPMD sharding, and GPU acceleration.
{%- endif -%}
{%- endset -%}

{%- set page_title -%}
{%- if pagename == 'index' -%}
Nabla ML — High-Performance Autodiff & Distributed ML in Python
{%- elif 'finetune' in pagename -%}
LoRA & QLoRA Fine-Tuning API — Nabla ML
{%- elif 'api/' in pagename -%}
{{ title }} API Reference — Nabla ML
{%- elif 'tutorials/' in pagename -%}
{{ title }} Tutorial — Nabla ML
{%- else -%}
{{ title }} — Nabla ML
{%- endif -%}
{%- endset -%}

{%- set base_url = "https://www.nablaml.com/" -%}

{%- block extrahead %}
<!-- SEO Meta Tags -->
<meta name="description" content="{{ page_description|trim }}" />
<meta name="keywords" content="nabla, machine learning framework, automatic differentiation, autodiff, JIT compilation, GPU computing, SPMD sharding, distributed training, deep learning, Mojo language, MAX engine, JAX alternative, PyTorch alternative, LoRA, QLoRA, fine-tuning, tensor operations, neural networks, pipeline parallelism, model parallelism, vmap, grad, {{ title|lower }}" />
<meta name="author" content="Nabla ML" />
<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
<meta name="googlebot" content="index, follow" />

<!-- Open Graph Meta Tags -->
<meta property="og:title" content="{{ page_title|trim }}" />
<meta property="og:type" content="{% if 'api/' in pagename %}article{% else %}website{% endif %}" />
{% if pagename == 'index' %}
<meta property="og:url" content="{{ base_url }}" />
{% else %}
<meta property="og:url" content="{{ base_url }}{{ pagename }}.html" />
{% endif %}
<meta property="og:image" content="{{ base_url }}_static/default-image.png" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />
<meta property="og:image:alt" content="Nabla ML — High-Performance Machine Learning Framework" />
<meta property="og:description" content="{{ page_description|trim }}" />
<meta property="og:site_name" content="Nabla ML" />
<meta property="og:locale" content="en_US" />

<!-- Twitter Card Meta Tags -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="{{ page_title|trim }}" />
<meta name="twitter:description" content="{{ page_description|trim }}" />
<meta name="twitter:image" content="{{ base_url }}_static/default-image.png" />
<meta name="twitter:site" content="@nablaml" />

<!-- Structured Data: WebSite (homepage only — enables Google Sitelinks search box) -->
{% if pagename == 'index' %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "Nabla ML Documentation",
  "url": "{{ base_url }}",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "{{ base_url }}search.html?q={search_term_string}",
    "query-input": "required name=search_term_string"
  }
}
</script>
{% endif %}

<!-- Structured Data: SoftwareApplication (homepage) or TechArticle (docs pages) -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  {% if pagename == 'index' -%}
  "@type": "SoftwareApplication",
  "name": "Nabla ML",
  "applicationCategory": "DeveloperApplication",
  "applicationSubCategory": "Machine Learning Framework",
  "operatingSystem": "Linux, macOS",
  "url": "{{ base_url }}",
  "description": "{{ page_description|trim }}",
  "softwareVersion": "{{ release }}",
  "dateModified": "{{ build_date }}",
  "license": "https://github.com/nabla-ml/nabla/blob/main/LICENSE",
  "codeRepository": "https://github.com/nabla-ml/nabla",
  "programmingLanguage": ["Python", "Mojo"],
  "keywords": "machine learning, automatic differentiation, JIT compilation, GPU computing, SPMD, distributed training, LoRA, QLoRA, fine-tuning, Mojo, JAX alternative",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD"
  },
  {%- else -%}
  "@type": "TechArticle",
  "headline": "{{ page_title|trim }}",
  "url": "{{ base_url }}{{ pagename }}.html",
  "description": "{{ page_description|trim }}",
  "dateModified": "{{ build_date }}",
  "proficiencyLevel": "{% if 'tutorials/' in pagename %}Beginner{% else %}Expert{% endif %}",
  {%- endif %}
  "author": {
    "@type": "Organization",
    "name": "Nabla ML",
    "url": "https://github.com/nabla-ml"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Nabla ML",
    "logo": {
      "@type": "ImageObject",
      "url": "{{ base_url }}_static/nabla-logo.png"
    }
  }
}
</script>

<!-- Structured Data: BreadcrumbList -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "{{ base_url }}"
    }
    {% if 'api/' in pagename %},
    {
      "@type": "ListItem",
      "position": 2,
      "name": "API Reference",
      "item": "{{ base_url }}api/index.html"
    }
    {% if pagename != 'api/index' %},
    {
      "@type": "ListItem",
      "position": 3,
      "name": "{{ title }}",
      "item": "{{ base_url }}{{ pagename }}.html"
    }
    {% endif %}
    {% elif 'tutorials/' in pagename %},
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Tutorials",
      "item": "{{ base_url }}tutorials/index.html"
    }
    {% if pagename != 'tutorials/index' %},
    {
      "@type": "ListItem",
      "position": 3,
      "name": "{{ title }}",
      "item": "{{ base_url }}{{ pagename }}.html"
    }
    {% endif %}
    {% endif %}
  ]
}
</script>

<!-- Note: canonical URL is automatically injected by sphinx_book_theme via html_baseurl -->
{%- endblock %}

{%- block htmltitle %}
<title>{{ page_title|trim }}</title>
{%- endblock %}